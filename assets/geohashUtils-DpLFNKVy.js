import{aG as A,aJ as R,ba as g,cM as W,cN as b}from"./index-D0xqwRGM.js";import{K as v}from"./featureConversionUtils-BEJnJ0j8.js";import{e as B}from"./OptimizedGeometry-CQuTPb9g.js";import{j as $}from"./timeSupport-DeqeB8YQ.js";const F=new Float64Array(2),T=new Float64Array(2),Y="0123456789bcdefghjkmnpqrstuvwxyz",k=64;function N(n,e,r,a){const t=[n.xmin,n.ymin,n.xmax,n.ymax],s=A.fromExtent(R.fromBounds(t,a)),c=$(s,a,g.WGS84,{densificationStep:e*k});if(!c)return null;const o=v(new B,c,!1,!1),u=o.coords.filter((G,h)=>!(h%2)),i=o.coords.filter((G,h)=>h%2),d=Math.min(...u),x=Math.min(...i),l=Math.max(...u),m=Math.max(...i),f=j(d,x,r,g.WGS84),y=j(l,m,r,g.WGS84);return f&&y?{bounds:t,geohashBounds:{xLL:f[0],yLL:f[1],xTR:y[0],yTR:y[1]},level:r}:null}function j(n,e,r,a){if(a.isWebMercator){const c=W(n/b.radius),o=c-360*Math.floor((c+180)/360),u=[0,0];return L(u,0,W(Math.PI/2-2*Math.atan(Math.exp(-e/b.radius))),o,r),u}const t=$({x:n,y:e},a,g.WGS84);if(!t)return null;const s=[0,0];return L(s,0,t.y,t.x,r),s}function q(n){return Y[n]}function z(n){return(n[0]+n[1])/2}function w(n,e,r){return n[0]=e,n[1]=r,n}function C(n,e){const r=z(n),a=e,t=!e;n[0]=t*n[0]+a*r,n[1]=t*r+a*n[1]}function M(n,e){const r=e>z(n);return C(n,r),r}function P(n,e){let r=-90,a=90,t=-180,s=180;for(let c=0;c<e;c++){const o=Math.ceil((c+1)/2),u=Math.floor((c+1)/2),i=1-c%2,d=30-(3*o+2*u),x=30-(2*o+3*u),l=3*i+2*(1-i),m=2*i+3*(1-i),f=3*i+7*(1-i)<<x,y=(7*i+3*(1-i)<<d&n.geohashX)>>d,G=(f&n.geohashY)>>x;for(let h=l-1;h>=0;h--){const S=(t+s)/2,p=y&1<<h?1:0;t=(1-p)*t+p*S,s=(1-p)*S+p*s}for(let h=m-1;h>=0;h--){const S=(r+a)/2,p=G&1<<h?1:0;r=(1-p)*r+p*S,a=(1-p)*S+p*a}}return[t,r,s,a]}function L(n,e,r,a,t){t%2&&(t+=1);let s=0,c=0,o=-90,u=90,i=-180,d=180;for(let x=0;x<t/2;x++){for(let l=0;l<5;l++){const m=(i+d)/2,f=a>m?1:0;s|=f<<29-(l+5*x),i=(1-f)*i+f*m,d=(1-f)*m+f*d}for(let l=0;l<5;l++){const m=(o+u)/2,f=r>m?1:0;c|=f<<29-(l+5*x),o=(1-f)*o+f*m,u=(1-f)*m+f*u}}n[2*e]=s,n[2*e+1]=c}function X(n,e,r){let a="";const t=w(F,-90,90),s=w(T,-180,180);for(let c=0;c<r;c++){let o=0;c%2?(o|=M(t,n)<<4,o|=M(s,e)<<3,o|=M(t,n)<<2,o|=M(s,e)<<1,o|=M(t,n)<<0):(o|=M(s,e)<<4,o|=M(t,n)<<3,o|=M(s,e)<<2,o|=M(t,n)<<1,o|=M(s,e)<<0),a+=q(o)}return a}export{j as A,P as R,N as S,X as z};
